const Stampery = require('./dist/stampery.js')
var stampery = new Stampery('b4022fdb-f790-42e7-a24f-f6c311d2dcfb')

var sleep = function (ms) {
  return new Promise(resolve => setTimeout(resolve, ms))
}

var h = stampery.hash('the piano has been drinking ' + Math.random())

stampery.stamp(h, function (err, stamp) {
  if (err) {
    return console.error(err)
  }

  console.log('RESPONSE stamp')
  console.log(stamp)

  // sleep for 10 seconds longer than predicted necessary
  sleep(stamp.receipts.eth * 1000).then(() => {
    stampery.getById(stamp.id, function (err, res) {
      if (err) {
        console.error('FAILED')
        return console.error(err)
      }

      if (res) {
        console.log('RESPONSE getById')
        console.log(res)

        console.log('PROVE IT')
        return console.log('Valid: ', stampery.prove(res.receipts))
      }
    })
  })
})
